# dev

A combination of multiple development tools and a workflow for developing [Drupal](https://www.drupal.org/) based projects primarily on GNU/Linux (Debian/Ubuntu) operating system.

There is a plan to try to get this workflow to work on other platforms (e.g., Microsoft Windows, OS X and other GNU/Linux distributions) in the future as well.

##  Install

    git clone http://git.simpledrupalcloud.com/simpledrupalcloud/dev.git "${HOME}/.drush/dev"

## Working with Drush

### List all the Drupal site aliases

     drush site-alias
     
Shortcut for this command is:

    drush sa
    
### Update database
    
    drush -y updatedb
    
Shortcut for this command is:

    drush -y updb
    
### Revert features

    drush -y features-revert-all

Shortcut for this command is:

    drush -y fra

### Copy settings file from a remote Drupal host

    drush -y rsync @example.com:sites/default/settings.php @self:sites/default

### Synchronize Drupal files directory between multiple Drupal instances

    drush -y rsync @example.com:%files @self:%files

### Synchronize Drupal database between multiple Drupal instances

The Drush core `sql-sync` command is somewhat limited when it comes to transferring huge databases between remote and local Drupal sites.

There is a tool called [Drush SQL Sync Pipe](https://www.drupal.org/project/drush_sql_sync_pipe) by [Mark Carver](https://www.drupal.org/u/mark-carver) that helps to solve this exact problem.

#### Installing Drush SQL Sync Pipe

    sudo apt-get install -y pv
    drush dl drush_sql_sync_pipe --destination=${HOME}/.drush

#### Working with Drush SQL Sync Pipe

    drush -y sql-sync-pipe @example.com @self --progress
    
Shortcut for this command is:

    drush -y ssp @example.com @self --progress
    drush -y pipe @example.com @self --progress

### Backing up a Drupal database

Clear Drupal cache tables before creating the database dump.

    drush cc all

Export Drupal database into a file.

    drush sql-dump > ~/sql_dump.sql

It's always a good practise to prepend a creation timestamp to your dump filename.

    drush sql-dump > ~/$(date "+%Y%m%d%H%M%S")_sql_dump.sql

### Restoring a Drupal database from a backup

Drop all the tables in your database before importing the dump.

    drush -y sql-drop

Import the database dump into MySQL server.

    drush sql-cli < ~/sql_dump.sql

Import gzipped database dump into MySQL server.

    gunzip sql_dump.sql.gz | drush sql-cli

### Change Drupal user password

    drush upwd admin --password="admin"

### SSH into remote Drupal instance

    drush @example.com site-ssh

Shortcut for this command is:

    drush @example.com ssh

### Go directly to MySQL CLI

    drush sql-cli

Shortcut for this command is:

    drush sqlc

## drush ftp-export-backup

Drush command that backs up files over FTP from local files. Local files may be generated by [svn-export](https://github.com/simpledrupalcloud/svn-export) or [git-export](https://github.com/simpledrupalcloud/git-export).

### Usage

    drush ftp-export-backup <EXPORTED_FILES_PATH> <HOST> <USERNAME> <PASSWORD> <BACKUP_PATH> [BASE_PATH]
    drush feb <EXPORTED_FILES_PATH> <HOST> <USERNAME> <PASSWORD> <BACKUP_PATH> [BASE_PATH]

## Workflow

![Flowchart](/flowchart.png)

## TODO

 * Logging
 * Backing up data volume containers

## License

**MIT**
